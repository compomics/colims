<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
    <sql-query name="SearchModification.getConstraintLessSearchModificationIdsForRuns">
        SELECT
        DISTINCT search_modification.id
        FROM search_modification
        LEFT JOIN search_params_has_modification ON search_params_has_modification.id = search_modification.id
        AND search_params_has_modification.id NOT IN
        (
        SELECT
        s_p_has_mod.id
        FROM search_params_has_modification s_p_has_mod
        JOIN search_parameters s_p ON s_p.id = s_p_has_mod.l_search_parameters_id
        JOIN search_and_validation_settings s_and_v_s ON s_and_v_s.l_search_parameters_id = s_p.id
        WHERE s_and_v_s.l_analytical_run_id IN (:ids)
        )
        WHERE search_params_has_modification.l_search_modification_id IS NULL
    </sql-query>
</hibernate-mapping>